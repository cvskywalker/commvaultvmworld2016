# Dynamically generated by Chef - local modifications will be overwritten

# Minimal nginx service configuration.

user <%= @run_user %><%= " #{@run_group}" unless @run_group.nil? %>;

worker_processes <%= @worker_processes.nil? ? 'auto' : @worker_processes %>;

error_log /var/log/<%= @nginx_instance_name %>/error.log <%= @error_log_level %>;
pid /var/run/<%= @nginx_instance_name %>.pid;


events {
  worker_connections <%= @worker_connections %>;
}


http {
  log_format main '$remote_addr - $remote_user [$time_local] "$request" '
                  '$status $body_bytes_sent "$http_referer" '
                  '"$http_user_agent" "$http_x_forwarded_for"';

  access_log /var/log/<%= @nginx_instance_name %>/access.log main;

<% @xtra_main_http_conf.each do |key, value| -%>
  <%= key %> <%= value %>;
<% end unless @xtra_main_http_conf.nil? -%>

  # All other directives should be placed in these directories
  include /etc/<%= @nginx_instance_name %>/conf.d/*.conf;
  include /etc/<%= @nginx_instance_name %>/sites-enabled/*;
}